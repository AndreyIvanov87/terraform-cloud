version: 3
#automerge: true
#delete_source_branch_on_merge: true
#parallel_plan: true
#parallel_apply: true

projects:
- name: my-project-name
  dir: .
  workspace: default
  #terraform_version: v0.11.0
  #delete_source_branch_on_merge: true
  autoplan:
    when_modified: ["*.tf", "../modules/**/*.tf"]
    enabled: true
  apply_requirements: [mergeable, approved]
  workflow: custom
workflows:
  custom:
    plan:
      steps:
      - run: echo 'plan start'
      - init
      - plan:
#          extra_args: ["-lock", "false"]
	   extra_args: ["-out", "/home/ivanov/"]
      - run: echo 'plan finish'
    apply:
      steps:
      - run: echo apply
      - apply
#allowed_regexp_prefixes:
#- dev/
#- staging/
